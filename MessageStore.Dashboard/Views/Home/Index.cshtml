@{
    ViewData["Title"] = "Home Page";
}

<div class="row" style="margin-bottom:20px">
    <h2>Messages</h2>
        <div class="col-md-12">
            <a class="btn btn-info" href="/Create">Add message</a>
        </div>
</div>

<div class="row">
    <div class="col-md-12">
        <table id="messages" class="table table-striped table-bordered dt-responsive nowrap" width="100%" cellspacing="0">  
            <thead>  
                <tr>  
                    <th>Title</th>
                    <th>Edit</th>
                    <th>Delete</th>
                </tr>  
            </thead>  
        </table> 
    </div>
</div>

<script>
    var messageTable;
     function DeleteData(CustomerID) {  
        if (confirm("Are you sure you want to delete ...?")) {  
            Delete(CustomerID);  
        }  
        else {  
            return false;  
        }  
    }  
  
    function Delete(messageId) {  
        var url = "http://127.0.0.1:5000/api/messages/";
         $.ajax({
            url: url + messageId,
            type: 'DELETE',
            success: function(result) {
                messageTable.ajax.reload();
            }
        });
    }  

    $(document).ready(function() {
        messageTable = $("#messages").DataTable({  
  
                "processing": false, // for show progress bar  
                "serverSide": false, // for process server side  
                "filter": false, // this is for disable filter (search box)  
                "orderMulti": false, // for disable multiple column at once  
                "pageLength": 5,  

                "ajax": {  
                    "url": "http://localhost:5000/api/messages/",  
                    "type": "GET",  
                    "datatype": "json",
                    "dataSrc": ''
                }, 
  
                "columnDefs":  
                [{  
                    "targets": [0],  
                    "visible": true,  
                    "searchable": false  
                }],  
  
                "columns": [  
                      { "data": "Title", "name": "Title", "autoWidth": true },  
                      {  
                          "render": function (data, type, full, meta)  
                          { return '<a class="btn btn-info" href="/Edit?messageId=' + full.Id + '">Edit</a>'; }  
                      },  
                       {  
                           data: null, render: function (data, type, row) {  
                               return "<a href='#' class='btn btn-danger' onclick=DeleteData('" + row.Id + "'); >Delete</a>";  
                           }  
                       },  
  
                ]  
  
            });  
    });
</script>